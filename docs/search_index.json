[["index.html", "Source code and supporting information for Drivers of diurnal variation in vocal activity in a tropical bird community Section 1 Introduction 1.1 Attribution 1.2 Data access 1.3 Data processing", " Source code and supporting information for Drivers of diurnal variation in vocal activity in a tropical bird community Vijay Ramesh Pavithra Sundar Meghana P Srivathsa Laurel Symes Last compiled on 17 July, 2024 Section 1 Introduction This is the readable version that showcases analyses examining the drivers of diurnal variation in vocal activity for a tropical bird community. 1.1 Attribution Please contact the following in case of interest in the project. Vijay Ramesh (repo maintainer) Postdoctoral Research Associate, Cornell Lab of Ornithology 1.2 Data access The data used in this work will be archived on Zenodo. 1.3 Data processing The data processing for this project is described in the following sections. Navigate through them using the links in the sidebar. "],["data-cleaning.html", "Section 2 Data cleaning 2.1 Install required libraries 2.2 Loading acoustic data 2.3 Add standardized eBird species codes for future analysis 2.4 How much data has been annotated for dawn and dusk across sites and days? 2.5 More data cleaning 2.6 Write to file", " Section 2 Data cleaning In this script, we will ensure that the data is cleaned, and we create a single sheet for annotations at dawn and another sheet for annotations at dusk. 2.1 Install required libraries library(tidyverse) library(dplyr) library(stringr) library(vegan) library(ggplot2) library(scico) library(data.table) library(extrafont) library(sf) library(raster) # for plotting library(scales) library(ggplot2) library(ggspatial) library(colorspace) 2.2 Loading acoustic data The acoustic data consists of annotations of 10-s chunks of audio files across summer and winter months. We will load annotation datasets for both dawn and dusk and process them further to ensure that we can quickly extract measures of vocal activity in future scripts. For the sake of future analysis, we define dawn as periods of acoustic data annotated between 6am and 10am. We define dusk as periods of acoustic data annotated between 4pm to 7pm. # These dawn and dusk annotation .csvs are not uploaded to GitHub and can be provided upon request # Please write to Vijay Ramesh if you would like to access the raw data - vr292@cornell.edu) # However, all outputs emerging from this script, which includes processed annotations are public and can be used for analysis # dawn data summer_dawn &lt;- read.csv(&quot;data/summer-dawn-annotations.csv&quot;) winter_dawn &lt;- read.csv(&quot;data/winter-dawn-annotations.csv&quot;) dawn &lt;- bind_rows(summer_dawn, winter_dawn) names(dawn) # reorder columns to ensure the species codes appear one after another dawn &lt;- dawn %&gt;% relocate(c(&quot;BFOW&quot;, &quot;SBEO&quot;, &quot;JUNI&quot;, &quot;ASKO&quot;, &quot;HSWO&quot;), .after = &quot;CORO&quot;) # split the filename column into 4 columns : site, date, time and splits dawn &lt;- separate(dawn, col = Filename, into = c(&quot;site_id&quot;, &quot;date&quot;, &quot;time&quot;, &quot;splits&quot;), sep = &quot;_&quot;) %&gt;% dplyr::select(-(Birds:Notes)) %&gt;% # remove columns not required &amp; rename rename(., restoration_type = Restoration.Type..Benchmark.Active.Passive.) %&gt;% rename(., time_of_day = Time..Morning.Evening.Night.) %&gt;% mutate(time_of_day = &quot;dawn&quot;) # dusk data summer_dusk &lt;- read.csv(&quot;data/summer-dusk-annotations.csv&quot;) winter_dusk &lt;- read.csv(&quot;data/winter-dusk-annotations.csv&quot;) dusk &lt;- bind_rows(summer_dusk, winter_dusk) names(dusk) # reorder columns to ensure the species codes appear one after another dusk &lt;- dusk %&gt;% relocate(&quot;GREN&quot;, .after = &quot;CORO&quot;) # split the filename column into 4 columns : site, date, time and splits dusk &lt;- separate(dusk, col = Filename, into = c(&quot;site_id&quot;, &quot;date&quot;, &quot;time&quot;, &quot;splits&quot;), sep = &quot;_&quot;) %&gt;% dplyr::select(-(Birds:Notes)) %&gt;% # remove columns not required &amp; rename rename(., restoration_type = Restoration.Type..Benchmark.Active.Passive.) %&gt;% rename(., time_of_day = Time..Morning.Evening.Night.) %&gt;% mutate(time_of_day = &quot;dusk&quot;) # create a single dataframe acoustic_data &lt;- bind_rows(dawn, dusk) 2.3 Add standardized eBird species codes for future analysis species_codes &lt;- read.csv(&quot;data/species-annotation-codes.csv&quot;) ## Using the splice operator from an example on stackOverflow ## https://stackoverflow.com/questions/60113369/change-column-names-in-dataframe-based-on-matching-to-another-dataframe-by-dplyr eBirdCodes &lt;- species_codes %&gt;% dplyr::select(eBird_codes, species_annotation_codes) %&gt;% deframe() # replace current annotation codes with eBird codes acoustic_data &lt;- acoustic_data %&gt;% rename(!!!eBirdCodes) 2.4 How much data has been annotated for dawn and dusk across sites and days? # we observe that OLCAP5B has the least amount of data annotated (~3 unique days/visits) at dawn dawnSampling &lt;- acoustic_data %&gt;% filter(time_of_day == &quot;dawn&quot;) %&gt;% dplyr::select(site_id, date) %&gt;% distinct() %&gt;% arrange(site_id) %&gt;% count(site_id) # we observe that OLCAP5B has the least amount of data annotated (~3 unique visits) duskSampling &lt;- acoustic_data %&gt;% filter(time_of_day == &quot;dusk&quot;) %&gt;% dplyr::select(site_id, date) %&gt;% distinct() %&gt;% arrange(site_id) %&gt;% count(site_id) 2.5 More data cleaning Removing NAs and renaming columns # Here, we pivot the data to long format and remove NA/zero values or missing data acoustic_data &lt;- acoustic_data %&gt;% group_by(site_id, date, time, splits, time_of_day, restoration_type) %&gt;% transform() %&gt;% replace(is.na(.), 0) %&gt;% summarise_at(.vars = vars(c(&quot;compea&quot;:&quot;grenig1&quot;)), .funs = sum) %&gt;% pivot_longer(cols = compea:grenig1, names_to = &quot;eBird_codes&quot;, values_to = &quot;number&quot;) %&gt;% filter(number != 0) # one way to remove zeros # rename the `time` column as `start_time` to distinguish from `time_of_day` acoustic_data &lt;- acoustic_data %&gt;% rename(., start_time = time) # add hourOfDay column to indicate time-windows for when the acoustic-visit was started acoustic_data &lt;- acoustic_data %&gt;% mutate( hour_of_day = case_when( start_time &gt;= &quot;060000&quot; &amp; start_time &lt; &quot;070000&quot; ~ &quot;6AM to 7AM&quot;, start_time &gt;= &quot;070000&quot; &amp; start_time &lt; &quot;080000&quot; ~ &quot;7AM to 8AM&quot;, start_time &gt;= &quot;080000&quot; &amp; start_time &lt; &quot;090000&quot; ~ &quot;8AM to 9AM&quot;, start_time &gt;= &quot;090000&quot; &amp; start_time &lt;= &quot;100000&quot; ~ &quot;9AM to 10AM&quot;, start_time &gt;= &quot;160000&quot; &amp; start_time &lt; &quot;170000&quot; ~ &quot;4PM to 5PM&quot;, start_time &gt;= &quot;170000&quot; &amp; start_time &lt;= &quot;180000&quot; ~ &quot;5PM to 6PM&quot;, start_time &gt;= &quot;180000&quot; &amp; start_time &lt;= &quot;190000&quot; ~ &quot;6PM to 7PM&quot;)) %&gt;% ungroup() # add a zero before the start_time to ensure its all 6 digits of time atleast acoustic_data &lt;- acoustic_data %&gt;% mutate(across(start_time, str_pad, width = 6, pad = &quot;0&quot;)) # keep only species that vocalize atleast across a minimum of 20 different/unique dates and times # we chose this random arbitrary threshold to include only species that are highly vocal and can be used for comparative analyses spp_subset &lt;- acoustic_data %&gt;% group_by(site_id, date, eBird_codes) %&gt;% summarise(unique_voc = sum(number)) %&gt;% ungroup() # keep only species with n &gt; 20 spp_subset &lt;- spp_subset %&gt;% group_by(eBird_codes) %&gt;% summarise(n = n()) %&gt;% filter(n &gt; 20) ## subset to only include species that were detected atleast across 20 unique data/time combinations acoustic_data &lt;- acoustic_data %&gt;% filter(eBird_codes %in% spp_subset$eBird_codes) ## Only 69 species remain after including highly vocal species alone 2.6 Write to file write.csv(acoustic_data, &quot;results/acoustic_data.csv&quot;, row.names = F) "],["vocal-activity.html", "Section 3 Vocal activity 3.1 Install necessary libraries 3.2 Load acoustic data and species scientific names data 3.3 Vocal activity across time periods 3.4 Is overall vocal activity much higher at dawn compared to dusk, across species? 3.5 Testing for differences in acoustic detections between dawn and dusk 3.6 Figure for publication", " Section 3 Vocal activity In this script, we examine differences in vocal activity between dawn and dusk for each species. 3.1 Install necessary libraries library(tidyverse) library(dplyr) library(stringr) library(vegan) library(ggplot2) library(scico) library(data.table) library(extrafont) library(ggstatsplot) library(rstatix) 3.2 Load acoustic data and species scientific names data acoustic_data &lt;- read.csv(&quot;results/acoustic_data.csv&quot;) species_codes &lt;- read.csv(&quot;data/species-annotation-codes.csv&quot;) 3.3 Vocal activity across time periods A number of factors need to be considered in further analysis: accounting for time_of_day, observed_identity for example. However, we run analyses that account for differences in calling activity by species for dawn and dusk. # sampling effort by time_of_day effort &lt;- acoustic_data %&gt;% dplyr::select(site_id, date, time_of_day) %&gt;% distinct() %&gt;% arrange(time_of_day) %&gt;% count(time_of_day) %&gt;% rename(., nVisits = n) # Above, we note that we had sampled ~293 site-date combinations at dawn, while ~245 site-date combinations were sampled at dusk # total number of acoustic detections summarized across every 10-s audio file # here, we estimate % detections at dawn and dusk, while accounting for sampling effort vocal_act &lt;- acoustic_data %&gt;% group_by(time_of_day, eBird_codes) %&gt;% summarise(detections = sum(number)) %&gt;% left_join(., species_codes[,c(1,2,5)], by = &quot;eBird_codes&quot;) %&gt;% group_by(eBird_codes) %&gt;% mutate(total_detections =sum(detections)) %&gt;% mutate(percent_detections = (detections/total_detections)*100) %&gt;% ungroup() ## accouting for sampling effort and normalizing data vocal_act &lt;- vocal_act %&gt;% left_join(., effort, by = &quot;time_of_day&quot;) %&gt;% mutate(normalized_detections = detections/nVisits) %&gt;% group_by(eBird_codes) %&gt;% mutate(total_normalized_detections = sum(normalized_detections)) %&gt;% mutate(percent_normalized_detections = (normalized_detections/total_normalized_detections)*100) %&gt;% ungroup() %&gt;% # in our case, we have 3 species which have 100% detections in dawn, Indian blackbird, Little spiderhunter and Purple sunbird. For these, we add a additional row specifying no detections in dusk. add_row(time_of_day= &#39;dusk&#39;, eBird_codes = &#39;pursun4&#39;, detections = 0, scientific_name = &#39;Cinnyris asiaticus&#39;, common_name = &#39;Purple Sunbird&#39;, total_detections = 315, percent_detections = 0, normalized_detections = 0, percent_normalized_detections = 0, nVisits = 245, total_normalized_detections = 1.075085) %&gt;% add_row(time_of_day= &#39;dusk&#39;, eBird_codes = &#39;eurbla2&#39;, detections = 0, scientific_name = &#39;Turdus simillimus&#39;, common_name = &#39;Indian Blackbird&#39;, total_detections = 236, percent_detections = 0,normalized_detections = 0, percent_normalized_detections = 0, nVisits = 245, total_normalized_detections = 0.8054608) %&gt;% add_row(time_of_day= &#39;dusk&#39;, eBird_codes = &#39;litspi1&#39;, detections = 0, scientific_name = &#39;Arachnothera longirostra&#39;, common_name = &#39;Little Spiderhunter&#39;, total_detections = 417, percent_detections = 0, normalized_detections = 0, nVisits = 245, percent_normalized_detections = 0, total_normalized_detections = 1.423208) # for the sake of plotting, we will create a new variable vocal_act$plot_percent &lt;- ifelse(vocal_act$time_of_day == &quot;dusk&quot;, -1*vocal_act$percent_normalized_detections, vocal_act$percent_normalized_detections) # reordering legend appearance vocal_act$time_of_day &lt;- factor(vocal_act$time_of_day, levels = c(&quot;dusk&quot;,&quot;dawn&quot;)) # figure of percent detections fig_percent_detections &lt;- ggplot(vocal_act, aes( x = reorder(common_name, plot_percent), y = plot_percent, fill = time_of_day)) + geom_text(aes(label=signif(abs(plot_percent),3)), hjust = ifelse(vocal_act$plot_percent &gt;= 0, 0, 1), size = 3) + geom_bar(stat = &quot;identity&quot;) + scale_fill_manual(values = c(&quot;#1b9e77&quot;,&quot;#d95f02&quot;)) + scale_y_continuous(labels=abs) + coord_flip() + labs(y = &#39;% Vocal Activity&#39;, x = &#39;Species Common Name&#39;) + theme_bw() + theme(text = element_text(family = &quot;Century Gothic&quot;, size = 10, face = &quot;bold&quot;),plot.title = element_text(family = &quot;Century Gothic&quot;, size = 15, face = &quot;bold&quot;), plot.subtitle = element_text(family = &quot;Century Gothic&quot;, size = 15, face = &quot;bold&quot;,color=&quot;#1b2838&quot;), axis.title = element_text(family = &quot;Century Gothic&quot;, size = 15, face = &quot;bold&quot;), legend.position = &quot;top&quot;, legend.title = element_blank(), legend.text=element_text(size=10)) ggsave(fig_percent_detections, filename = &quot;figs/fig_percentDetections_species.png&quot;, width = 14, height = 16, device = png(), units = &quot;in&quot;, dpi = 300) dev.off() % acoustic detections for each species between dawn and dusk 3.4 Is overall vocal activity much higher at dawn compared to dusk, across species? fig_overall_vocal_act &lt;- vocal_act %&gt;% filter(time_of_day == &quot;dawn&quot;) %&gt;% ggbetweenstats(x = time_of_day, y = percent_normalized_detections, xlab = &quot;Time of Day&quot;, ylab = &quot;% Overall Vocal Activity at Dawn&quot;, pairwise.display = &quot;significant&quot;, violin.args = list(width = 0), ggplot.component = list(theme(text = element_text(family = &quot;Century Gothic&quot;, size = 10, face = &quot;bold&quot;),plot.title = element_text(family = &quot;Century Gothic&quot;, size = 15, face = &quot;bold&quot;), plot.subtitle = element_text(family = &quot;Century Gothic&quot;, size = 15, face = &quot;bold&quot;,color=&quot;#1b2838&quot;), axis.title = element_text(family = &quot;Century Gothic&quot;, size = 15, face = &quot;bold&quot;)))) + coord_flip()+ scale_color_manual(values = c(&quot;#d95f02&quot;,&quot;#1b9e77&quot;)) ## Edits made to figure to show only data for dawn (since % activity is significantly higher than dusk ggsave(fig_overall_vocal_act, filename = &quot;figs/fig_percentDetections_overall.png&quot;, width = 14, height = 7, device = png(), units = &quot;in&quot;, dpi = 300) dev.off() Overall, higher vocal activity was detected at dawn compared to dusk, across species. % acoustic detections for each species between dawn and dusk 3.5 Testing for differences in acoustic detections between dawn and dusk Here, we see whether there are differences in the acoustic detections for each species between dawn and dusk. stat.test &lt;- vocal_act %&gt;% pairwise_wilcox_test(detections ~ time_of_day) # We observe significant differences in acoustic detections across species between dawn and dusk # A tibble: 1 × 9 # .y. group1 group2 n1 n2 statistic p p.adj p.adj.signif # &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;int&gt; &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt; # detections dawn dusk 69 69 3192. 0.000549 0.000549 *** 3.6 Figure for publication # Here, we will combine the above two figures created library(patchwork) fig_vocAct &lt;- wrap_plots(fig_overall_vocal_act, fig_percent_detections, nrow = 2) + plot_annotation( tag_levels = &quot;a&quot;, tag_prefix = &quot;(&quot;, tag_suffix = &quot;)&quot;) + plot_layout(heights = c(1, 8)) ggsave(fig_vocAct, filename = &quot;figs/fig01.png&quot;, width = 14, height = 20, device = png(), units = &quot;in&quot;, dpi = 300) dev.off() Figure 1. (a) Vocal activity was significantly higher at dawn compared to dusk across a tropical bird community in the Western Ghats. (b) Species-specific vocal activity across dawn and dusk. "],["frequency.html", "Section 4 Frequency 4.1 Install necessary libraries 4.2 Load acoustic data and species scientific names data 4.3 Vocal activity data 4.4 Frequency data 4.5 Visualization of % detections vs. median peak frequency", " Section 4 Frequency In this script, we examine differences in vocal activity between dawn and dusk for each species as a function of frequency. The expectation is that higher frequency vocalizers would call more at dawn compared to dusk, owing to better signal transmission in the morning. 4.1 Install necessary libraries library(tidyverse) library(dplyr) library(stringr) library(vegan) library(ggplot2) library(scico) library(data.table) library(extrafont) library(ggstatsplot) library(ggpubr) library(ggrepel) 4.2 Load acoustic data and species scientific names data acoustic_data &lt;- read.csv(&quot;results/acoustic_data.csv&quot;) species_codes &lt;- read.csv(&quot;data/species-annotation-codes.csv&quot;) freq &lt;- read.csv(&quot;data/frequency-data.csv&quot;) 4.3 Vocal activity data # sampling effort by time_of_day effort &lt;- acoustic_data %&gt;% dplyr::select(site_id, date, time_of_day) %&gt;% distinct() %&gt;% arrange(time_of_day) %&gt;% count(time_of_day) %&gt;% rename(., nVisits = n) # total number of acoustic detections summarized across every 10-s audio file # here, we estimate % detections at dawn and dusk, while accounting for sampling effort vocal_act &lt;- acoustic_data %&gt;% group_by(time_of_day, eBird_codes) %&gt;% summarise(detections = sum(number)) %&gt;% left_join(., species_codes[,c(1,2,5)], by = &quot;eBird_codes&quot;) %&gt;% group_by(eBird_codes) %&gt;% mutate(total_detections =sum(detections)) %&gt;% mutate(percent_detections = (detections/total_detections)*100) %&gt;% ungroup() ## accouting for sampling effort and normalizing data vocal_act &lt;- vocal_act %&gt;% left_join(., effort, by = &quot;time_of_day&quot;) %&gt;% mutate(normalized_detections = detections/nVisits) %&gt;% group_by(eBird_codes) %&gt;% mutate(total_normalized_detections = sum(normalized_detections)) %&gt;% mutate(percent_normalized_detections = (normalized_detections/total_normalized_detections)*100) %&gt;% ungroup() 4.4 Frequency data We will extract the median peak frequency for each species. Note: For a total of 114 species, template recordings (varying from a minimum of 2 templates to 1910 templates per species) was extracted by Meghana P Srivathsa. While extracting median peak frequency, no distinction was made between songs and calls. We removed species that had very few templates (we only kept species that had a minimum of five frequency related measures). # add standardized eBird codes to the frequency data freq &lt;-left_join (freq, species_codes[c(3,5)], by = &quot;species_annotation_codes&quot;) # Only a total of 99 species are left after filtering species with very few templates nTemplates_5 &lt;- freq %&gt;% group_by(eBird_codes) %&gt;% count() %&gt;% filter(n &gt;= 5) %&gt;% drop_na() # left-join to remove species with less than five templates in the frequency dataset freq_5 &lt;- left_join(nTemplates_5[,1], freq) # calculate median peak frequency median_pf &lt;- freq_5 %&gt;% group_by(eBird_codes) %&gt;% summarise(median_peak_freq = median(peak_freq_in_Hz)) ## join the frequency data to the vocal activity data voc_freq &lt;- left_join(vocal_act, median_pf, by = &quot;eBird_codes&quot;) %&gt;% drop_na() # A total of 66 species were included and three species were excluded due to lack of data. 4.5 Visualization of % detections vs. median peak frequency Here, we model the % of detections at dawn as a function of median peak frequency. # we will filter the data to only include dawn dawn &lt;- voc_freq %&gt;% mutate(log_freq = log10(median_peak_freq)) %&gt;% filter(time_of_day == &quot;dawn&quot;) # the only species that was excluded above was pied bushchat, which was reported only from dusk fig_freq_vocAct &lt;- ggplot(dawn, aes(x=log_freq, y= percent_normalized_detections)) + geom_point(shape = 21, colour = &quot;black&quot;, fill = &quot;white&quot;, size = 2, stroke = 1)+ geom_smooth(method=&quot;lm&quot;, se=TRUE, fullrange=FALSE, level=0.95,linetype=&quot;solid&quot;) + theme_bw() + stat_regline_equation(label.x = 2.4, aes(label = ..eq.label..), label.y = 25, size = 6, family = &quot;Century Gothic&quot;) + stat_regline_equation(label.x = 2.4, aes(label = ..rr.label..), label.y = 20, size = 6, family = &quot;Century Gothic&quot;) + labs(y=&quot;\\n % Vocal activity at Dawn&quot;, x=&quot; log (Median Peak Frequency)\\n&quot;) + geom_text_repel(aes(label = common_name), family = &quot;Century Gothic&quot;, fontface = &quot;italic&quot;) + theme(text = element_text(family = &quot;Century Gothic&quot;, size = 18, face = &quot;bold&quot;),plot.title = element_text(family = &quot;Century Gothic&quot;, size = 18, face = &quot;bold&quot;), plot.subtitle = element_text(family = &quot;Century Gothic&quot;, size = 15, face = &quot;bold&quot;,color=&quot;#1b2838&quot;), axis.title = element_text(family = &quot;Century Gothic&quot;, size = 18, face = &quot;bold&quot;)) ggsave(fig_freq_vocAct, filename = &quot;figs/fig_peakFrequency_vs_dawnDetections.png&quot;, width = 14, height = 16, device = png(), units = &quot;in&quot;, dpi = 300) dev.off() % acoustic detections at dawn vs. median peak frequency shows no significant relationship "],["light-availability.html", "Section 5 Light availability 5.1 Install necessary libraries 5.2 Load acoustic data and species scientific names data 5.3 Extract light availability for each date 5.4 Model acoustic detections as a function of light availability 5.5 Paired statistical test to assess if the slopes (of detections ~ timing of vocalization) are significantly different between dawn and dusk across species 5.6 Visualization of timing of vocalization", " Section 5 Light availability In this script, we examine differences in vocal activity between dawn and dusk as a function of light availability. The expectation is that species would call much earlier in the day, closer to sunrise compared to later in the day when one could spend time foraging. 5.1 Install necessary libraries library(tidyverse) library(dplyr) library(stringr) library(vegan) library(ggplot2) library(scico) library(data.table) library(extrafont) library(ggstatsplot) library(suncalc) library(lutz) library(stringr) library(ggpmisc) library(ggpubr) library(hms) library(RColorBrewer) 5.2 Load acoustic data and species scientific names data acoustic_data &lt;- read.csv(&quot;results/acoustic_data.csv&quot;) sites &lt;- read.csv(&quot;data/list-of-sites.csv&quot;) species_codes &lt;- read.csv(&quot;data/species-annotation-codes.csv&quot;) 5.3 Extract light availability for each date # add longitude and latitude to acoustic_data acoustic_data &lt;- left_join(acoustic_data, sites[,c(2,4,5)], by = &quot;site_id&quot;) acoustic_data$date &lt;- lubridate::ymd(acoustic_data$date) names(acoustic_data)[c(10,11)] &lt;- c(&quot;lon&quot;,&quot;lat&quot;) # find out what time zone needs to be provided for the sunlight calculations acoustic_data$tz &lt;- tz_lookup_coords(lat = acoustic_data$lat, lon = acoustic_data$lon, method = &quot;accurate&quot;, warn = FALSE) # extract nauticalDawn, nauticalDusk, sunrise and sunset times light_data &lt;- getSunlightTimes(data = acoustic_data, keep = c(&quot;sunrise&quot;,&quot;sunset&quot;, &quot;nauticalDawn&quot;, &quot;nauticalDusk&quot;), tz = &quot;Asia/Kolkata&quot;) %&gt;% distinct(.) # strip dates from new columms and keep only time light_data$sunrise &lt;- as_hms(light_data$sunrise) light_data$sunset &lt;- as_hms(light_data$sunset) light_data$nauticalDawn &lt;- as_hms(light_data$nauticalDawn) light_data$nauticalDusk &lt;- as_hms(light_data$nauticalDusk) # format the start_time column in the acoustic data to keep it as the same format as light_data acoustic_data &lt;- acoustic_data %&gt;% mutate(across(start_time, str_pad, width = 6, pad = &quot;0&quot;)) acoustic_data$start_time&lt;- format(strptime(acoustic_data$start_time, format = &quot;%H%M%S&quot;), format = &quot;%H:%M:%S&quot;) acoustic_data$start_time &lt;- as_hms(acoustic_data$start_time) # summarize detections of species for every 15-min window acoustic_data &lt;- acoustic_data %&gt;% group_by(site_id, date, start_time, time_of_day, eBird_codes, lon, lat, hour_of_day) %&gt;% summarise(detections = sum(number)) %&gt;% ungroup() # join the two datasets acoustic_data &lt;- left_join(acoustic_data, light_data, by = c(&quot;date&quot;,&quot;lon&quot;,&quot;lat&quot;)) # subtract times from sunrise, sunset, nauticalDawn and nauticalDusk from start_time of acoustic detections acoustic_data &lt;- acoustic_data %&gt;% mutate(time_from_dawn = as.numeric((start_time - nauticalDawn), units = &quot;hours&quot;)) %&gt;% mutate(time_from_sunrise = as.numeric((start_time - sunrise), units = &quot;hours&quot;)) %&gt;% mutate(time_to_dusk = as.numeric((nauticalDusk-start_time), units = &quot;hours&quot;)) %&gt;% mutate(time_to_sunset = as.numeric((sunset-start_time), units = &quot;hours&quot;)) 5.4 Model acoustic detections as a function of light availability Here, we choose times of day as proxies for light availability (ie. nautical dawn, dusk for example). # Here, we make the assumption that light levels are fairly similar closer to dawn and closer to dusk. Hence, we model the number of acoustic detections as a function of time to dusk and time from dawn. # add species_codes/common_name to the above dataset acoustic_data &lt;- acoustic_data %&gt;% left_join(., species_codes[,c(1,2,5)], by = &quot;eBird_codes&quot;) %&gt;% ungroup() # visualization plots &lt;- list() # collect slope and other coefficient information here metadata &lt;- c() for(i in 1:length(unique(acoustic_data$common_name))) { # extract species common_name a &lt;- unique(acoustic_data$common_name)[i] # subset data for plotting sp &lt;- acoustic_data[acoustic_data$common_name==a,] # bind dawn and dusk data together dawn &lt;- sp %&gt;% filter(time_of_day == &quot;dawn&quot;) %&gt;% dplyr::select(detections, time_from_dawn, time_of_day) %&gt;% rename(., time_from_startTime = time_from_dawn) dusk &lt;- sp %&gt;% filter(time_of_day == &quot;dusk&quot;) %&gt;% dplyr::select(detections, time_to_dusk, time_of_day) %&gt;% rename(., time_from_startTime = time_to_dusk) data &lt;- bind_rows(dawn, dusk) plots[[i]] &lt;- ggplot(data, aes(x= time_from_startTime, y= detections, fill = time_of_day)) + geom_point(shape = 21, aes(fill = time_of_day), size = 2, stroke = 1, alpha = 0.7)+ geom_smooth(method=&quot;lm&quot;, se=TRUE, fullrange=FALSE, level=0.95,linetype=&quot;solid&quot;, aes(color = time_of_day)) + scale_fill_manual(values = c(&quot;#d95f02&quot;,&quot;#1b9e77&quot;))+ scale_color_manual(values = c(&quot;#d95f02&quot;,&quot;#1b9e77&quot;)) + theme_bw() + labs(title = a, subtitle = &quot;Each dot represents the total number of detections after dawn or before dusk (in hours)&quot;, y=&quot;\\n Number of acoustic detections&quot;, x=&quot;Time to darkness\\n&quot;) + theme(text = element_text(family = &quot;Century Gothic&quot;, size = 18, face = &quot;bold&quot;),plot.title = element_text(family = &quot;Century Gothic&quot;, size = 18, face = &quot;bold&quot;), plot.subtitle = element_text(family = &quot;Century Gothic&quot;, size = 15, face = &quot;italic&quot;,color=&quot;#1b2838&quot;), axis.title = element_text(family = &quot;Century Gothic&quot;, size = 18, face = &quot;bold&quot;)) # collect metadata data &lt;- setDT(data) # extract t-value data[, t_value := summary(lm(detections ~ time_from_startTime))$coefficients[6], by = time_of_day] # extract slope data[, slope := lm(detections ~ time_from_startTime) %&gt;% coef()%&gt;% nth(2), by = time_of_day] # extract adjusted r squared data[, r_sq := summary(lm(detections ~ time_from_startTime))$adj.r.squared, by = time_of_day] # create a column with the direction of the slope (whether it is positive or negative) data[, slope_dir := ifelse(slope &gt;0, &#39;+&#39;, &#39;-&#39;)] # extract distinct values of coefficients for each species lm_output &lt;- data %&gt;% dplyr::select(time_of_day, t_value, slope, slope_dir,r_sq) %&gt;% distinct() %&gt;% mutate(common_name = a) ## add the above to the metadata object metadata &lt;- bind_rows(metadata, lm_output) } # save as a single pdf cairo_pdf( filename = &quot;figs/acoustic-detections-time-to-darkness.pdf&quot;, width = 13, height = 12, onefile = TRUE ) plots dev.off() # write metadata to file write.csv(metadata, &quot;results/slopes-detections-lightAvailability.csv&quot;, row.names = F) 5.5 Paired statistical test to assess if the slopes (of detections ~ timing of vocalization) are significantly different between dawn and dusk across species stat.test &lt;- metadata %&gt;% filter(common_name != &quot;White-throated Kingfisher&quot;) %&gt;% filter(common_name != &quot;Oriental-Magpie Robin&quot;) %&gt;% filter(common_name != &quot;Malabar Trogon&quot;) %&gt;% filter(common_name != &quot;Gray-headed Canary-Flycatcher&quot;) %&gt;% pairwise_wilcox_test(slope ~ time_of_day) # No significant differences were observed between the slopes across dawn and dusk. Here the slope conveys the relationship between the number of acoustic detections and timing of vocalization # A tibble: 1 × 9 # .y. group1 group2 n1 n2 statistic p p.adj p.adj.signif #* &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;int&gt; &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt; #1 slope dawn dusk 66 63 1885 0.362 0.362 ns 5.6 Visualization of timing of vocalization # sampling effort by hour_of_day effort &lt;- acoustic_data %&gt;% dplyr::select(site_id, date, hour_of_day) %&gt;% distinct() %&gt;% arrange(hour_of_day) %&gt;% count(hour_of_day) %&gt;% rename(., nVisits = n) # visualization plots &lt;- list() for(i in 1:length(unique(acoustic_data$common_name))) { # extract species common_name a &lt;- unique(acoustic_data$common_name)[i] # subset data for plotting sp &lt;- acoustic_data[acoustic_data$common_name==a,] %&gt;% group_by(hour_of_day) %&gt;% summarise(detections = sum(detections)) %&gt;% mutate(total_detections =sum(detections)) %&gt;% ungroup() # normalize for sampling effort sp &lt;- left_join(sp, effort, by = &quot;hour_of_day&quot;) %&gt;% mutate(normalized_detections = (detections/nVisits)) %&gt;% mutate(total_normalized_detections = sum(normalized_detections)) %&gt;% mutate(percent_normalized_detections = (normalized_detections/total_normalized_detections)*100) %&gt;% ungroup() # add a break/no data for mid-day sp &lt;- sp %&gt;% add_row(hour_of_day = &quot;Mid-day&quot;, nVisits = 0, detections = 0, total_detections = 0, normalized_detections = 0, total_normalized_detections = 0, percent_normalized_detections = 0) # reordering factors for plotting sp$hour_of_day &lt;- factor(sp$hour_of_day, levels = c(&quot;6AM to 7AM&quot;, &quot;7AM to 8AM&quot;, &quot;8AM to 9AM&quot;, &quot;9AM to 10AM&quot;, &quot;Mid-day&quot;, &quot;4PM to 5PM&quot;, &quot;5PM to 6PM&quot;, &quot;6PM to 7PM&quot;)) plots[[i]] &lt;- ggplot(sp, aes(x=hour_of_day, y=percent_normalized_detections)) + geom_bar(stat = &quot;identity&quot;, position = position_dodge(), fill = &quot;#883107&quot;, alpha = 0.9) + geom_text(aes(label = ifelse(percent_normalized_detections &gt; 0, round(percent_normalized_detections, 1), &quot;&quot;), hjust = &quot;middle&quot;, vjust = -0.5, family = &quot;Century Gothic&quot;), position = position_dodge(), angle = 0, size = 5) + theme_bw() + labs(title = a, subtitle = &quot;Each bar represents the percent detections (normalized for sampling effort) across dawn and dusk&quot;, y=&quot;\\n %acoustic detections&quot;, x=&quot;Time of Day\\n&quot;) + theme(text = element_text(family = &quot;Century Gothic&quot;, size = 18, face = &quot;bold&quot;),plot.title = element_text(family = &quot;Century Gothic&quot;, size = 18, face = &quot;bold&quot;), plot.subtitle = element_text(family = &quot;Century Gothic&quot;, size = 15, face = &quot;italic&quot;,color=&quot;#1b2838&quot;), axis.title = element_text(family = &quot;Century Gothic&quot;, size = 18, face = &quot;bold&quot;)) } # save as a single pdf cairo_pdf( filename = &quot;figs/acoustic-detections-hour-of-day.pdf&quot;, width = 13, height = 12, onefile = TRUE ) plots dev.off() "],["foraging-guild.html", "Section 6 Foraging guild 6.1 Install necessary libraries 6.2 Load acoustic data and species scientific names data 6.3 Vocal activity data 6.4 Join the vocal_activity data and species trait data 6.5 Testing the differences among trophic niche categories using Wilcoxon test 6.6 Visualization of % detections vs. trophic niche", " Section 6 Foraging guild Here, we ask if species of a certain foraging guild have higher vocal activity at dawn compared to dusk. Our null hypothesis/expectation is that there would be no differences in vocal activity across foraging guilds irrespective of time of day. 6.1 Install necessary libraries library(tidyverse) library(dplyr) library(stringr) library(vegan) library(ggplot2) library(scico) library(data.table) library(extrafont) library(ggstatsplot) library(ggpubr) library(ggrepel) library(patchwork) library(rstatix) 6.2 Load acoustic data and species scientific names data acoustic_data &lt;- read.csv(&quot;results/acoustic_data.csv&quot;) species_codes &lt;- read.csv(&quot;data/species-annotation-codes.csv&quot;) trait &lt;- read.csv(&quot;data/species-trait-dat.csv&quot;) 6.3 Vocal activity data # sampling effort by time_of_day effort &lt;- acoustic_data %&gt;% dplyr::select(site_id, date, time_of_day) %&gt;% distinct() %&gt;% arrange(time_of_day) %&gt;% count(time_of_day) %&gt;% rename(., nVisits = n) # Above, we note that we had sampled ~293 site-date combinations at dawn, while ~245 site-date combinations were sampled at dusk # total number of acoustic detections summarized across every 10-s audio file # here, we estimate % detections at dawn and dusk, while accounting for sampling effort vocal_act &lt;- acoustic_data %&gt;% group_by(time_of_day, eBird_codes) %&gt;% summarise(detections = sum(number)) %&gt;% left_join(., species_codes[,c(1,2,5)], by = &quot;eBird_codes&quot;) %&gt;% group_by(eBird_codes) %&gt;% mutate(total_detections =sum(detections)) %&gt;% mutate(percent_detections = (detections/total_detections)*100) %&gt;% ungroup() ## accouting for sampling effort and normalizing data vocal_act &lt;- vocal_act %&gt;% left_join(., effort, by = &quot;time_of_day&quot;) %&gt;% mutate(normalized_detections = detections/nVisits) %&gt;% group_by(eBird_codes) %&gt;% mutate(total_normalized_detections = sum(normalized_detections)) %&gt;% mutate(percent_normalized_detections = (normalized_detections/total_normalized_detections)*100) %&gt;% ungroup() %&gt;% # in our case, we have 3 species which have 100% detections in dawn, Indian blackbird, Little spiderhunter and Purple sunbird. For these, we add a additional row specifying no detections in dusk. add_row(time_of_day= &#39;dusk&#39;, eBird_codes = &#39;pursun4&#39;, detections = 0, scientific_name = &#39;Cinnyris asiaticus&#39;, common_name = &#39;Purple Sunbird&#39;, total_detections = 315, percent_detections = 0, normalized_detections = 0, percent_normalized_detections = 0, nVisits = 245, total_normalized_detections = 1.075085) %&gt;% add_row(time_of_day= &#39;dusk&#39;, eBird_codes = &#39;eurbla2&#39;, detections = 0, scientific_name = &#39;Turdus simillimus&#39;, common_name = &#39;Indian Blackbird&#39;, total_detections = 236, percent_detections = 0,normalized_detections = 0, percent_normalized_detections = 0, nVisits = 245, total_normalized_detections = 0.8054608) %&gt;% add_row(time_of_day= &#39;dusk&#39;, eBird_codes = &#39;litspi1&#39;, detections = 0, scientific_name = &#39;Arachnothera longirostra&#39;, common_name = &#39;Little Spiderhunter&#39;, total_detections = 417, percent_detections = 0, normalized_detections = 0, nVisits = 245, percent_normalized_detections = 0, total_normalized_detections = 1.423208) 6.4 Join the vocal_activity data and species trait data vocal_act &lt;- vocal_act %&gt;% left_join(trait[,c(1,2,29)], by = c(&#39;scientific_name&#39;, &#39;common_name&#39;)) ## remove species that are poorly represented by a particular trophic niche ## we get rid of nectarivore species, aquatic predator and granivore vocal_act &lt;- vocal_act %&gt;% filter(trophic_niche != &quot;Aquatic predator&quot;) %&gt;% filter(trophic_niche != &quot;Granivore&quot;) %&gt;% filter(trophic_niche != &quot;Nectarivore&quot;) %&gt;% filter(trophic_niche != &quot;Vertivore&quot;) ## We retained 62 out of 69 species after the above filters 6.5 Testing the differences among trophic niche categories using Wilcoxon test Here, we see whether there are differences in the vocal activity between invertivores, frugivores, and omnivores in dawn and dusk individually. stat.test &lt;- vocal_act %&gt;% group_by (time_of_day) %&gt;% wilcox_test (percent_normalized_detections ~ trophic_niche) Significant differences were observed between frugivore and omnivore species at dawn and dusk, as well as between frugivore and invertivore species. 6.6 Visualization of % detections vs. trophic niche fig_trophicNiche_vocAct &lt;- vocal_act %&gt;% filter(time_of_day == &quot;dawn&quot;) %&gt;% ggbetweenstats(x = trophic_niche, y = percent_normalized_detections, xlab = &quot;Foraging guild&quot;, ylab = &quot;% Vocal activity at Dawn&quot;, pairwise.display = &quot;significant&quot;, package = &quot;ggsci&quot;, palette = &quot;default_jco&quot;, violin.args = list(width = 0), ggplot.component = list(theme(text = element_text(family = &quot;Century Gothic&quot;, size = 15, face = &quot;bold&quot;),plot.title = element_text(family = &quot;Century Gothic&quot;, size = 18, face = &quot;bold&quot;), plot.subtitle = element_text(family = &quot;Century Gothic&quot;, size = 15, face = &quot;bold&quot;,color=&quot;#1b2838&quot;), axis.title = element_text(family = &quot;Century Gothic&quot;, size = 15, face = &quot;bold&quot;)))) ggsave(fig_trophicNiche_vocAct, filename = &quot;figs/fig_percentDetections_foragingGuild.png&quot;, width = 16, height = 14, device = png(), units = &quot;in&quot;, dpi = 300) dev.off() We observe significant differences in vocal activity for frugivorous, invertivorous and omnivorous species between dawn and dusk, where much higher acoustic detections or calling was observed/detected at dawn compared to dusk. % acoustic detections at dawn across foraging guilds "],["territoriality.html", "Section 7 Territoriality 7.1 Loading necessary libraries 7.2 Loading territoriality data 7.3 Load acoustic data and species scientific names data 7.4 Vocal activity data 7.5 Join the vocal_activity data and territoriality data 7.6 Testing the differences between territoriality categories using Wilcoxon test 7.7 Visualization of % detections vs. territoriality", " Section 7 Territoriality In this script, we examine the role of territoriality in vocal activity between dawn and dusk. The expectation is that highly territorial, weakly territorial and non-territorial species have higher vocal activity in dawn than dusk. Highly territorial species are those which defend and maintain their territories throughout the year. Weakly territorial species are those which have broadly overlapping home ranges, or sometimes join mixed flocks without defined spatial ranges. Non-territorial species are those which do not defend territories, or defend very small areas around nest sites, or defend song or display posts only. 7.1 Loading necessary libraries library(tidyverse) library(dplyr) library(stringr) library(vegan) library(ggplot2) library(scico) library(data.table) library(extrafont) library(ggstatsplot) library(purrr) library(ggpubr) library(ggrepel) library(ggdist) library(gghalves) library(rstatix) 7.2 Loading territoriality data territoriality &lt;- read.csv(&quot;data/territoriality-data.csv&quot;) territoriality &lt;- territoriality %&gt;% dplyr::select (Species, Territory) colnames (territoriality) &lt;- c(&quot;scientific_name&quot;, &quot;territory&quot;) # Updating the scientific names of following species as per our dataset: # Flame-throated bulbul- Rubigula gularis (earlier Pycnonotus gularis) # Black eagle- Ictinaetus malaiensis (earlier Ictinaetus malayensis) # Brown-capped pygmy woodpecker- Yungipicus nanus (earlier Dendrocopos nanus) # Malabar barbet- Psilopogon malabaricus (earlier Megalaima malabarica) # Dark-fronted babbler- Dumetia atriceps (earlier Rhopocichla atriceps) # Greater flameback- Chrysocolaptes guttacristatus (earlier Chrysocolaptes lucidus) # Indian blue robin- Larvivora brunnea (earlier Luscinia brunnea) # Indian yellow tit- Machlolophus aplonotus (earlier Parus aplonotus) # Jungle babbler- Argya striata (earlier Turdoides striata) # Orange-headed thrush- Geokichla citrina (earlier Zoothera citrina) # Rufous babbler- Argya subrufa (earlier Turdoides subrufa) # Rufous woodpecker- Micropternus brachyurus (earlier Celeus brachyurus) # Rusty-tailed flycatcher- Ficedula ruficauda (earlier Muscicapa ruficauda # Spot-bellied eagle owl- Ketupa nipalensis (earlier Bubo nipalensis) # Spotted dove- Spilopelia chinensis (earlier Stigmatopelia chinensis) # Thick-billed warbler- Arundinax aedon (earlier Acrocephalus aedon) # White-bellied flycatcher- Cyornis pallidipes (earlier Cyornis pallipes) # White-cheeked barbet- Psilopogon viridis (earlier Megalaima viridis) # Wayanad laughingthrush- Pterorhinus delesserti (earlier Garrulax delesserti) # Yellow-browed bulbul- Iole indica (earlier Acritillas indica) territoriality &lt;- territoriality %&gt;% mutate(scientific_name = recode (scientific_name, &#39;Pycnonotus gularis&#39; = &#39;Rubigula gularis&#39;, &#39;Ictinaetus malayensis&#39; = &#39;Ictinaetus malaiensis&#39;, &#39;Dendrocopos nanus&#39; = &#39;Yungipicus nanus&#39;, &#39;Megalaima malabarica&#39; = &#39;Psilopogon malabaricus&#39;, &#39;Rhopocichla atriceps&#39; = &#39;Dumetia atriceps&#39;, &#39;Chrysocolaptes lucidus&#39; = &#39;Chrysocolaptes guttacristatus&#39;, &#39;Luscinia brunnea&#39; = &#39;Larvivora brunnea&#39;, &#39;Parus aplonotus&#39; = &#39;Machlolophus aplonotus&#39;, &#39;Turdoides striata&#39; = &#39;Argya striata&#39;, &#39;Zoothera citrina&#39; = &#39;Geokichla citrina&#39;, &#39;Turdoides subrufa&#39; = &#39;Argya subrufa&#39;, &#39;Celeus brachyurus&#39; = &#39;Micropternus brachyurus&#39;, &#39;Muscicapa ruficauda&#39; = &#39;Ficedula ruficauda&#39;, &#39;Bubo nipalensis&#39; = &#39;Ketupa nipalensis&#39;, &#39;Stigmatopelia chinensis&#39; = &#39;Spilopelia chinensis&#39;, &#39;Acrocephalus aedon&#39; = &#39;Arundinax aedon&#39;, &#39;Cyornis pallipes&#39; = &#39;Cyornis pallidipes&#39;, &#39;Megalaima viridis&#39; = &#39;Psilopogon viridis&#39;, &#39;Garrulax delesserti&#39; = &#39;Pterorhinus delesserti&#39;, &#39;Acritillas indica&#39; = &#39;Iole indica&#39; )) 7.3 Load acoustic data and species scientific names data acoustic_data &lt;- read.csv(&quot;results/acoustic_data.csv&quot;) species_codes &lt;- read.csv(&quot;data/species-annotation-codes.csv&quot;) 7.4 Vocal activity data # sampling effort by time_of_day effort &lt;- acoustic_data %&gt;% dplyr::select(site_id, date, time_of_day) %&gt;% distinct() %&gt;% arrange(time_of_day) %&gt;% count(time_of_day) %&gt;% rename(., nVisits = n) # Above, we note that we had sampled ~293 site-date combinations at dawn, while ~245 site-date combinations were sampled at dusk # total number of acoustic detections summarized across every 10-s audio file # here, we estimate % detections at dawn and dusk, while accounting for sampling effort vocal_act &lt;- acoustic_data %&gt;% group_by(time_of_day, eBird_codes) %&gt;% summarise(detections = sum(number)) %&gt;% left_join(., species_codes[,c(1,2,5)], by = &quot;eBird_codes&quot;) %&gt;% group_by(eBird_codes) %&gt;% mutate(total_detections =sum(detections)) %&gt;% mutate(percent_detections = (detections/total_detections)*100) %&gt;% ungroup() ## accouting for sampling effort and normalizing data vocal_act &lt;- vocal_act %&gt;% left_join(., effort, by = &quot;time_of_day&quot;) %&gt;% mutate(normalized_detections = detections/nVisits) %&gt;% group_by(eBird_codes) %&gt;% mutate(total_normalized_detections = sum(normalized_detections)) %&gt;% mutate(percent_normalized_detections = (normalized_detections/total_normalized_detections)*100) %&gt;% ungroup() %&gt;% # in our case, we have 3 species which have 100% detections in dawn, Indian blackbird, Little spiderhunter and Purple sunbird. For these, we add a additional row specifying no detections in dusk. add_row(time_of_day= &#39;dusk&#39;, eBird_codes = &#39;pursun4&#39;, detections = 0, scientific_name = &#39;Cinnyris asiaticus&#39;, common_name = &#39;Purple Sunbird&#39;, total_detections = 315, percent_detections = 0, normalized_detections = 0, percent_normalized_detections = 0, nVisits = 245, total_normalized_detections = 1.075085) %&gt;% add_row(time_of_day= &#39;dusk&#39;, eBird_codes = &#39;eurbla2&#39;, detections = 0, scientific_name = &#39;Turdus simillimus&#39;, common_name = &#39;Indian Blackbird&#39;, total_detections = 236, percent_detections = 0,normalized_detections = 0, percent_normalized_detections = 0, nVisits = 245, total_normalized_detections = 0.8054608) %&gt;% add_row(time_of_day= &#39;dusk&#39;, eBird_codes = &#39;litspi1&#39;, detections = 0, scientific_name = &#39;Arachnothera longirostra&#39;, common_name = &#39;Little Spiderhunter&#39;, total_detections = 417, percent_detections = 0, normalized_detections = 0, nVisits = 245, percent_normalized_detections = 0, total_normalized_detections = 1.423208) 7.5 Join the vocal_activity data and territoriality data vocal_act &lt;- vocal_act %&gt;% left_join(territoriality, by = &#39;scientific_name&#39;) %&gt;% dplyr::mutate(territory_cat = case_when (territory %in% &#39;3&#39; ~&#39;Highly territorial&#39;, territory %in% &#39;2&#39; ~ &#39;Weakly territorial&#39;, territory %in% &#39;1&#39; ~&#39;Non-territorial&#39;)) There are 19 highly territorial, 11 non-territorial and 39 weakly territorial species in both dawn and dusk. 7.6 Testing the differences between territoriality categories using Wilcoxon test Here, we see whether there are differences in the vocal activity among highly territorial, weakly territorial and non-territorial species in dawn and dusk individually. stat.test &lt;- vocal_act %&gt;% group_by(time_of_day) %&gt;% wilcox_test(percent_normalized_detections ~ territory_cat) Vocal activity is significantly higher in dawn than dusk in all territorial categories. 7.7 Visualization of % detections vs. territoriality ## between dawn and dusk fig_terr_vocAct &lt;- vocal_act %&gt;% filter(time_of_day == &quot;dawn&quot;) %&gt;% mutate(territory_cat = fct_relevel(territory_cat, &quot;Highly territorial&quot;, &quot;Weakly territorial&quot;, &quot;Non-territorial&quot;)) %&gt;% ggbetweenstats(x = territory_cat, y = percent_normalized_detections, xlab = &quot;Extent of territoriality&quot;, ylab = &quot;% Vocal activity at Dawn&quot;, pairwise.display = &quot;significant&quot;, package = &quot;ggsci&quot;, palette = &quot;default_jco&quot;, violin.args = list(width = 0), ggplot.component = list(theme(text = element_text(family = &quot;Century Gothic&quot;, size = 15, face = &quot;bold&quot;),plot.title = element_text(family = &quot;Century Gothic&quot;, size = 18, face = &quot;bold&quot;), plot.subtitle = element_text(family = &quot;Century Gothic&quot;, size = 15, face = &quot;bold&quot;,color=&quot;#1b2838&quot;), axis.title = element_text(family = &quot;Century Gothic&quot;, size = 15, face = &quot;bold&quot;)))) ggsave(fig_terr_vocAct, filename = &quot;figs/fig_percentDetections_territoriality.png&quot;, width = 16, height = 14, device = png(), units = &quot;in&quot;, dpi = 300) dev.off() Vocal activity is significantly higher in dawn than dusk in all territorial categories. % acoustic detections at dawn across categories of territoriality "],["sociality.html", "Section 8 Sociality 8.1 Loading necessary libraries 8.2 Loading sociality data 8.3 Load acoustic data and species scientific names data 8.4 Vocal activity data 8.5 Join the vocal_activity data and sociality data 8.6 Testing the differences between socialiaty categories using Wilcoxon test 8.7 Visualization of % detections vs. sociality", " Section 8 Sociality In this script, we examine the role of sociality in vocal activity between dawn and dusk. The expectation is that communal and non-communal signalling species have higher vocal activity in dawn than dusk. Communal signallers are species that produce long-range acoustic signals in groups, either duets (two individuals) or choruses (three or more individuals) by both males and females. Non-communal signallers are species that sing as single individuals and not communally. 8.1 Loading necessary libraries library(tidyverse) library(dplyr) library(stringr) library(vegan) library(ggplot2) library(scico) library(data.table) library(extrafont) library(purrr) library(ggstatsplot) library(ggpubr) library(ggrepel) library(ggdist) library(gghalves) library(rstatix) 8.2 Loading sociality data sociality &lt;- read.csv(&quot;data/sociality-data.csv&quot;) sociality &lt;- sociality %&gt;% dplyr::select (Species, Communal) colnames (sociality) &lt;- c(&quot;scientific_name&quot;, &quot;sociality&quot;) # Updating the scientific names of following species as per our dataset: # Flame-throated bulbul- Rubigula gularis (earlier Pycnonotus gularis) # Black eagle- Ictinaetus malaiensis (earlier Ictinaetus malayensis) # Brown-capped pygmy woodpecker- Yungipicus nanus (earlier Dendrocopos nanus) # Malabar barbet- Psilopogon malabaricus (earlier Megalaima malabarica) # Dark-fronted babbler- Dumetia atriceps (earlier Rhopocichla atriceps) # Greater flameback- Chrysocolaptes guttacristatus (earlier Chrysocolaptes lucidus) # Indian blue robin- Larvivora brunnea (earlier Luscinia brunnea) # Indian yellow tit- Machlolophus aplonotus (earlier Parus aplonotus) # Jungle babbler- Argya striata (earlier Turdoides striata) # Orange-headed thrush- Geokichla citrina (earlier Zoothera citrina) # Rufous babbler- Argya subrufa (earlier Turdoides subrufa) # Rufous woodpecker- Micropternus brachyurus (earlier Celeus brachyurus) # Rusty-tailed flycatcher- Ficedula ruficauda (earlier Muscicapa ruficauda # Spot-bellied eagle owl- Ketupa nipalensis (earlier Bubo nipalensis) # Spotted dove- Spilopelia chinensis (earlier Stigmatopelia chinensis) # Thick-billed warbler- Arundinax aedon (earlier Acrocephalus aedon) # White-bellied flycatcher- Cyornis pallidipes (earlier Cyornis pallipes) # White-cheeked barbet- Psilopogon viridis (earlier Megalaima viridis) # Wayanad laughingthrush- Pterorhinus delesserti (earlier Garrulax delesserti) # Yellow-browed bulbul- Iole indica (earlier Acritillas indica) sociality &lt;- sociality %&gt;% mutate(scientific_name = recode (scientific_name, &#39;Pycnonotus gularis&#39; = &#39;Rubigula gularis&#39;, &#39;Ictinaetus malayensis&#39; = &#39;Ictinaetus malaiensis&#39;, &#39;Dendrocopos nanus&#39; = &#39;Yungipicus nanus&#39;, &#39;Megalaima malabarica&#39; = &#39;Psilopogon malabaricus&#39;, &#39;Rhopocichla atriceps&#39; = &#39;Dumetia atriceps&#39;, &#39;Chrysocolaptes lucidus&#39; = &#39;Chrysocolaptes guttacristatus&#39;, &#39;Luscinia brunnea&#39; = &#39;Larvivora brunnea&#39;, &#39;Parus aplonotus&#39; = &#39;Machlolophus aplonotus&#39;, &#39;Turdoides striata&#39; = &#39;Argya striata&#39;, &#39;Zoothera citrina&#39; = &#39;Geokichla citrina&#39;, &#39;Turdoides subrufa&#39; = &#39;Argya subrufa&#39;, &#39;Celeus brachyurus&#39; = &#39;Micropternus brachyurus&#39;, &#39;Muscicapa ruficauda&#39; = &#39;Ficedula ruficauda&#39;, &#39;Bubo nipalensis&#39; = &#39;Ketupa nipalensis&#39;, &#39;Stigmatopelia chinensis&#39; = &#39;Spilopelia chinensis&#39;,&#39;Acrocephalus aedon&#39; = &#39;Arundinax aedon&#39;, &#39;Cyornis pallipes&#39; = &#39;Cyornis pallidipes&#39;, &#39;Megalaima viridis&#39; = &#39;Psilopogon viridis&#39;, &#39;Garrulax delesserti&#39; = &#39;Pterorhinus delesserti&#39;, &#39;Acritillas indica&#39; = &#39;Iole indica&#39; )) 8.3 Load acoustic data and species scientific names data acoustic_data &lt;- read.csv(&quot;results/acoustic_data.csv&quot;) species_codes &lt;- read.csv(&quot;data/species-annotation-codes.csv&quot;) 8.4 Vocal activity data # sampling effort by time_of_day effort &lt;- acoustic_data %&gt;% dplyr::select(site_id, date, time_of_day) %&gt;% distinct() %&gt;% arrange(time_of_day) %&gt;% count(time_of_day) %&gt;% rename(., nVisits = n) # Above, we note that we had sampled ~293 site-date combinations at dawn, while ~245 site-date combinations were sampled at dusk # total number of acoustic detections summarized across every 10-s audio file # here, we estimate % detections at dawn and dusk, while accounting for sampling effort vocal_act &lt;- acoustic_data %&gt;% group_by(time_of_day, eBird_codes) %&gt;% summarise(detections = sum(number)) %&gt;% left_join(., species_codes[,c(1,2,5)], by = &quot;eBird_codes&quot;) %&gt;% group_by(eBird_codes) %&gt;% mutate(total_detections =sum(detections)) %&gt;% mutate(percent_detections = (detections/total_detections)*100) %&gt;% ungroup() ## accouting for sampling effort and normalizing data vocal_act &lt;- vocal_act %&gt;% left_join(., effort, by = &quot;time_of_day&quot;) %&gt;% mutate(normalized_detections = detections/nVisits) %&gt;% group_by(eBird_codes) %&gt;% mutate(total_normalized_detections = sum(normalized_detections)) %&gt;% mutate(percent_normalized_detections = (normalized_detections/total_normalized_detections)*100) %&gt;% ungroup() %&gt;% # in our case, we have 3 species which have 100% detections in dawn, Indian blackbird, Little spiderhunter and Purple sunbird. For these, we add a additional row specifying no detections in dusk. add_row(time_of_day= &#39;dusk&#39;, eBird_codes = &#39;pursun4&#39;, detections = 0, scientific_name = &#39;Cinnyris asiaticus&#39;, common_name = &#39;Purple Sunbird&#39;, total_detections = 315, percent_detections = 0, normalized_detections = 0, percent_normalized_detections = 0, nVisits = 245, total_normalized_detections = 1.075085) %&gt;% add_row(time_of_day= &#39;dusk&#39;, eBird_codes = &#39;eurbla2&#39;, detections = 0, scientific_name = &#39;Turdus simillimus&#39;, common_name = &#39;Indian Blackbird&#39;, total_detections = 236, percent_detections = 0,normalized_detections = 0, percent_normalized_detections = 0, nVisits = 245, total_normalized_detections = 0.8054608) %&gt;% add_row(time_of_day= &#39;dusk&#39;, eBird_codes = &#39;litspi1&#39;, detections = 0, scientific_name = &#39;Arachnothera longirostra&#39;, common_name = &#39;Little Spiderhunter&#39;, total_detections = 417, percent_detections = 0, normalized_detections = 0, nVisits = 245, percent_normalized_detections = 0, total_normalized_detections = 1.423208) 8.5 Join the vocal_activity data and sociality data vocal_act &lt;- vocal_act %&gt;% left_join(sociality, by = &#39;scientific_name&#39;) %&gt;% dplyr::mutate(sociality_cat = case_when (sociality %in% &#39;0&#39; ~ &#39;Non-communal signallers&#39;, sociality %in% &#39;1&#39; ~ &#39;Communal signallers&#39;)) 8.6 Testing the differences between socialiaty categories using Wilcoxon test Here, we see whether there are differences in the vocal activity between communal and non-communal signallers in dawn and dusk individually. stat.test &lt;- vocal_act %&gt;% group_by (time_of_day) %&gt;% wilcox_test (percent_normalized_detections ~ sociality_cat) No significant differences were observed in vocal activity between communal signallers and non-communal signallers at dawn or dusk. 8.7 Visualization of % detections vs. sociality ## between dawn and dusk fig_soc_vocAct &lt;- vocal_act %&gt;% filter(time_of_day == &quot;dawn&quot;) %&gt;% ggbetweenstats(x = sociality_cat, y = percent_normalized_detections, xlab = &quot;Levels of sociality&quot;, ylab = &quot;&quot;, pairwise.display = &quot;significant&quot;, package = &quot;ggsci&quot;, palette = &quot;default_jco&quot;, violin.args = list(width = 0), ggplot.component = list(theme(text = element_text(family = &quot;Century Gothic&quot;, size = 15, face = &quot;bold&quot;),plot.title = element_text(family = &quot;Century Gothic&quot;, size = 18, face = &quot;bold&quot;), plot.subtitle = element_text(family = &quot;Century Gothic&quot;, size = 15, face = &quot;bold&quot;,color=&quot;#1b2838&quot;), axis.title = element_text(family = &quot;Century Gothic&quot;, size = 15, face = &quot;bold&quot;)))) ggsave(fig_soc_vocAct, filename = &quot;figs/fig_percentDetections_vs_sociality.png&quot;, width = 16, height = 14, device = png(), units = &quot;in&quot;, dpi = 300) dev.off() Vocal activity is significantly higher in dawn than dusk in both sociality categories. ## Creating figure for publication library(patchwork) # We will combine the territoriality and communal signalling figure into a side-by-side panel # Assumption here that the territoriality figure is already loaded in the R environment (if not; please run the previous script for the same) fig_terr_soc &lt;- wrap_plots(fig_terr_vocAct, fig_soc_vocAct, ncol = 2) + plot_annotation( tag_levels = &quot;a&quot;, tag_prefix = &quot;(&quot;, tag_suffix = &quot;)&quot;) ggsave(fig_terr_soc, filename = &quot;figs/fig04.png&quot;, width = 16, height = 14, device = png(), units = &quot;in&quot;, dpi = 300) dev.off() "],["phylogenetic-generalized-least-squares-pgls-regressions.html", "Section 9 Phylogenetic Generalized Least Squares (PGLS) regressions 9.1 Loading necessary libraries 9.2 Loading necessary data 9.3 Getting the maximum credibility tree from the nexus file 9.4 Vocal Activity 9.5 Light availability 9.6 Territoriality 9.7 Sociality 9.8 Peak frequency 9.9 Foraging guild 9.10 Data cleaning 9.11 PGLS analysis", " Section 9 Phylogenetic Generalized Least Squares (PGLS) regressions In this script, we examine which predictor/hypothesis (light availability, peak frequency, trophic niche, territoriality, and sociality) best explains the variation in vocal activity between dawn and dusk. We use linear regresssions while controlling for potential phylogenetic signals/relationships. 9.1 Loading necessary libraries library(ape) library(nlme) library(geiger) library(phytools) library(phangorn) library(dplyr) library(tidyverse) library(tidyr) library(ggplot2) library(stringr) library(vegan) library(scico) library(data.table) library(extrafont) library(suncalc) library(lutz) library(ggpmisc) library(ggpubr) library(hms) library(phyr) library(sjPlot) 9.2 Loading necessary data acoustic_data &lt;- read.csv(&quot;results/acoustic_data.csv&quot;) species_codes &lt;- read.csv(&quot;data/species-annotation-codes.csv&quot;) trait &lt;- read.csv(&quot;data/species-trait-dat.csv&quot;) territoriality &lt;- read.csv(&quot;data/territoriality-data.csv&quot;) sociality &lt;- read.csv(&quot;data/sociality-data.csv&quot;) freq &lt;- read.csv(&quot;data/frequency-data.csv&quot;) sites &lt;- read.csv(&quot;data/list-of-sites.csv&quot;) vegetation &lt;- read.csv(&quot;data/vegetation-data.csv&quot;) tree &lt;- read.nexus(&quot;data/birdtree.nex&quot;) #obtained 100 trees using Hackett all species 9.3 Getting the maximum credibility tree from the nexus file tree &lt;- mcc(tree) 9.4 Vocal Activity We use normalized percent detections (percent detections which account for sampling effort) as a response variable in our PGLS analysis. # sampling effort by time_of_day effort &lt;- acoustic_data %&gt;% dplyr::select(site_id, date, time_of_day) %&gt;% distinct() %&gt;% arrange(time_of_day) %&gt;% count(time_of_day) %&gt;% rename(., nVisits = n) # Above, we note that we had sampled ~293 site-date combinations at dawn, while ~245 site-date combinations were sampled at dusk # total number of acoustic detections summarized across every 10-s audio file # here, we estimate % detections at dawn and dusk, while accounting for sampling effort vocal_act &lt;- acoustic_data %&gt;% group_by(time_of_day, eBird_codes) %&gt;% summarise(detections = sum(number)) %&gt;% left_join(., species_codes[,c(1,2,5)], by = &quot;eBird_codes&quot;) %&gt;% group_by(eBird_codes) %&gt;% mutate(total_detections =sum(detections)) %&gt;% mutate(percent_detections = (detections/total_detections)*100) %&gt;% ungroup() ## accouting for sampling effort and normalizing data vocal_act &lt;- vocal_act %&gt;% left_join(., effort, by = &quot;time_of_day&quot;) %&gt;% mutate(normalized_detections = detections/nVisits) %&gt;% group_by(eBird_codes) %&gt;% mutate(total_normalized_detections = sum(normalized_detections)) %&gt;% mutate(percent_normalized_detections = (normalized_detections/total_normalized_detections)*100) %&gt;% ungroup() 9.5 Light availability Here, we prepare a predictor for light availability or time to darkness for the PGLS analysis # add longitude and latitude to acoustic_data acoustic_data &lt;- left_join(acoustic_data, sites[,c(2,4,5)], by = &quot;site_id&quot;) acoustic_data$date &lt;- lubridate::ymd(acoustic_data$date) names(acoustic_data)[c(10,11)] &lt;- c(&quot;lon&quot;,&quot;lat&quot;) # find out what time zone needs to be provided for the sunlight calculations acoustic_data$tz &lt;- tz_lookup_coords(lat = acoustic_data$lat, lon = acoustic_data$lon, method = &quot;accurate&quot;, warn = FALSE) # extract nauticalDawn, nauticalDusk, sunrise and sunset times light_data &lt;- getSunlightTimes(data = acoustic_data, keep = c(&quot;sunrise&quot;,&quot;sunset&quot;, &quot;nauticalDawn&quot;, &quot;nauticalDusk&quot;), tz = &quot;Asia/Kolkata&quot;) %&gt;% distinct(.) # strip dates from new columms and keep only time light_data$sunrise &lt;- as_hms(light_data$sunrise) light_data$sunset &lt;- as_hms(light_data$sunset) light_data$nauticalDawn &lt;- as_hms(light_data$nauticalDawn) light_data$nauticalDusk &lt;- as_hms(light_data$nauticalDusk) # format the start_time column in the acoustic data to keep it as the same format as light_data acoustic_data &lt;- acoustic_data %&gt;% mutate(across(start_time, str_pad, width = 6, pad = &quot;0&quot;)) acoustic_data$start_time&lt;- format(strptime(acoustic_data$start_time, format = &quot;%H%M%S&quot;), format = &quot;%H:%M:%S&quot;) acoustic_data$start_time &lt;- as_hms(acoustic_data$start_time) # summarize detections of species for every 15-min window acoustic_data &lt;- acoustic_data %&gt;% group_by(site_id, date, start_time, time_of_day, eBird_codes, lon, lat) %&gt;% summarise(detections = sum(number)) %&gt;% ungroup() # join the two datasets acoustic_data &lt;- left_join(acoustic_data, light_data, by = c(&quot;date&quot;,&quot;lon&quot;,&quot;lat&quot;)) # subtract times from sunrise, sunset, nauticalDawn and nauticalDusk from start_time of acoustic detections acoustic_data &lt;- acoustic_data %&gt;% mutate(time_from_dawn = as.numeric((start_time - nauticalDawn), units = &quot;hours&quot;)) %&gt;% mutate(time_from_sunrise = as.numeric((start_time - sunrise), units = &quot;hours&quot;)) %&gt;% mutate(time_to_dusk = as.numeric((nauticalDusk-start_time), units = &quot;hours&quot;)) %&gt;% mutate(time_to_sunset = as.numeric((sunset-start_time), units = &quot;hours&quot;)) # add species scientific name to this data acoustic_data &lt;- acoustic_data %&gt;% left_join(., species_codes[,c(1, 5)], by = &quot;eBird_codes&quot;) # binding dawn and dusk times together to get at median time/light availability at dawn dawn &lt;- acoustic_data %&gt;% group_by (eBird_codes) %&gt;% filter(time_of_day == &quot;dawn&quot;) %&gt;% dplyr::select(time_from_dawn, time_of_day) %&gt;% rename(., time_from_startTime = time_from_dawn) %&gt;% summarise(median_startTime =median(time_from_startTime)) %&gt;% mutate (time_of_day = &#39;dawn&#39;) dusk &lt;- acoustic_data %&gt;% group_by (eBird_codes) %&gt;% filter(time_of_day == &quot;dusk&quot;) %&gt;% dplyr::select(time_to_dusk, time_of_day) %&gt;% rename(., time_from_startTime = time_to_dusk) %&gt;% summarise(median_startTime =median(time_from_startTime)) %&gt;% mutate (time_of_day = &#39;dusk&#39;) light &lt;- bind_rows (dawn, dusk)# this dataframe gives us the median time from dawn and time to dusk for each species vocal_act &lt;- vocal_act %&gt;% left_join(light, by = c(&#39;eBird_codes&#39;, &#39;time_of_day&#39;)) #adding median time from dawn and time to dusk to vocal activity data 9.6 Territoriality We prepare territoriality as a predictor for the PGLS analysis territoriality &lt;- territoriality %&gt;% dplyr::select (Species, Territory) colnames (territoriality) &lt;- c(&quot;scientific_name&quot;, &quot;territory&quot;) # Updating the scientific names of following species as per our dataset: # Flame-throated bulbul- Rubigula gularis (earlier Pycnonotus gularis) # Black eagle- Ictinaetus malaiensis (earlier Ictinaetus malayensis) # Brown-capped pygmy woodpecker- Yungipicus nanus (earlier Dendrocopos nanus) # Malabar barbet- Psilopogon malabaricus (earlier Megalaima malabarica) # Dark-fronted babbler- Dumetia atriceps (earlier Rhopocichla atriceps) # Greater flameback- Chrysocolaptes guttacristatus (earlier Chrysocolaptes lucidus) # Indian blue robin- Larvivora brunnea (earlier Luscinia brunnea) # Indian yellow tit- Machlolophus aplonotus (earlier Parus aplonotus) # Jungle babbler- Argya striata (earlier Turdoides striata) # Orange-headed thrush- Geokichla citrina (earlier Zoothera citrina) # Rufous babbler- Argya subrufa (earlier Turdoides subrufa) # Rufous woodpecker- Micropternus brachyurus (earlier Celeus brachyurus) # Rusty-tailed flycatcher- Ficedula ruficauda (earlier Muscicapa ruficauda # Spot-bellied eagle owl- Ketupa nipalensis (earlier Bubo nipalensis) # Spotted dove- Spilopelia chinensis (earlier Stigmatopelia chinensis) # Thick-billed warbler- Arundinax aedon (earlier Acrocephalus aedon) # White-bellied flycatcher- Cyornis pallidipes (earlier Cyornis pallipes) # White-cheeked barbet- Psilopogon viridis (earlier Megalaima viridis) # Wayanad laughingthrush- Pterorhinus delesserti (earlier Garrulax delesserti) # Yellow-browed bulbul- Iole indica (earlier Acritillas indica) territoriality &lt;- territoriality %&gt;% mutate(scientific_name = recode (scientific_name, &#39;Pycnonotus gularis&#39; = &#39;Rubigula gularis&#39;, &#39;Ictinaetus malayensis&#39; = &#39;Ictinaetus malaiensis&#39;, &#39;Dendrocopos nanus&#39; = &#39;Yungipicus nanus&#39;, &#39;Megalaima malabarica&#39; = &#39;Psilopogon malabaricus&#39;, &#39;Rhopocichla atriceps&#39; = &#39;Dumetia atriceps&#39;, &#39;Chrysocolaptes lucidus&#39; = &#39;Chrysocolaptes guttacristatus&#39;, &#39;Luscinia brunnea&#39; = &#39;Larvivora brunnea&#39;, &#39;Parus aplonotus&#39; = &#39;Machlolophus aplonotus&#39;, &#39;Turdoides striata&#39; = &#39;Argya striata&#39;, &#39;Zoothera citrina&#39; = &#39;Geokichla citrina&#39;, &#39;Turdoides subrufa&#39; = &#39;Argya subrufa&#39;, &#39;Celeus brachyurus&#39; = &#39;Micropternus brachyurus&#39;, &#39;Muscicapa ruficauda&#39; = &#39;Ficedula ruficauda&#39;, &#39;Bubo nipalensis&#39; = &#39;Ketupa nipalensis&#39;, &#39;Stigmatopelia chinensis&#39; = &#39;Spilopelia chinensis&#39;, &#39;Acrocephalus aedon&#39; = &#39;Arundinax aedon&#39;, &#39;Cyornis pallipes&#39; = &#39;Cyornis pallidipes&#39;, &#39;Megalaima viridis&#39; = &#39;Psilopogon viridis&#39;, &#39;Garrulax delesserti&#39; = &#39;Pterorhinus delesserti&#39;, &#39;Acritillas indica&#39; = &#39;Iole indica&#39;)) vocal_act &lt;- vocal_act %&gt;% left_join(territoriality, by = &#39;scientific_name&#39;) 9.7 Sociality We prepare sociality as a predictor for the PGLS analysis sociality &lt;- sociality %&gt;% dplyr::select (Species, Communal) colnames (sociality) &lt;- c(&quot;scientific_name&quot;, &quot;sociality&quot;) # Updating the scientific names of following species as per our dataset: see list in the code chunk for Territoriality sociality &lt;- sociality %&gt;% mutate(scientific_name = recode (scientific_name, &#39;Pycnonotus gularis&#39; = &#39;Rubigula gularis&#39;, &#39;Ictinaetus malayensis&#39; = &#39;Ictinaetus malaiensis&#39;, &#39;Dendrocopos nanus&#39; = &#39;Yungipicus nanus&#39;, &#39;Megalaima malabarica&#39; = &#39;Psilopogon malabaricus&#39;, &#39;Rhopocichla atriceps&#39; = &#39;Dumetia atriceps&#39;, &#39;Chrysocolaptes lucidus&#39; = &#39;Chrysocolaptes guttacristatus&#39;, &#39;Luscinia brunnea&#39; = &#39;Larvivora brunnea&#39;, &#39;Parus aplonotus&#39; = &#39;Machlolophus aplonotus&#39;, &#39;Turdoides striata&#39; = &#39;Argya striata&#39;, &#39;Zoothera citrina&#39; = &#39;Geokichla citrina&#39;, &#39;Turdoides subrufa&#39; = &#39;Argya subrufa&#39;, &#39;Celeus brachyurus&#39; = &#39;Micropternus brachyurus&#39;, &#39;Muscicapa ruficauda&#39; = &#39;Ficedula ruficauda&#39;, &#39;Bubo nipalensis&#39; = &#39;Ketupa nipalensis&#39;, &#39;Stigmatopelia chinensis&#39; = &#39;Spilopelia chinensis&#39;,&#39;Acrocephalus aedon&#39; = &#39;Arundinax aedon&#39;, &#39;Cyornis pallipes&#39; = &#39;Cyornis pallidipes&#39;, &#39;Megalaima viridis&#39; = &#39;Psilopogon viridis&#39;, &#39;Garrulax delesserti&#39; = &#39;Pterorhinus delesserti&#39;, &#39;Acritillas indica&#39; = &#39;Iole indica&#39;)) vocal_act &lt;- vocal_act %&gt;% left_join(sociality, by = &#39;scientific_name&#39;) 9.8 Peak frequency We prepare peak frequency as a predictor for the PGLS analysis # add standardized eBird codes to the frequency data freq &lt;-left_join (freq, species_codes[c(3,5)], by = &quot;species_annotation_codes&quot;) # Only a total of 99 species are left after filtering species with very few templates nTemplates_5 &lt;- freq %&gt;% group_by(eBird_codes) %&gt;% count() %&gt;% filter(n &gt;= 5) %&gt;% drop_na() # left-join to remove species with less than 10 templates in the frequency dataset freq_5 &lt;- left_join(nTemplates_5[,1], freq) # calculate median peak frequency after grouping by time of day and species median_pf &lt;- separate(freq_5, col = filename, into = c(&quot;site_id&quot;, &quot;date&quot;, &quot;time&quot;, &quot;splits&quot;), sep = &quot;_&quot;) %&gt;% mutate( time_of_day = case_when(time &gt;= &#39;060000&#39; &amp; time &lt;= &#39;100000&#39; ~ &#39;dawn&#39;, time &gt;= &#39;160000&#39; &amp; time &lt;= &#39;190000&#39; ~ &#39;dusk&#39;)) %&gt;% group_by(eBird_codes, time_of_day) %&gt;% summarise(median_peak_freq = median(peak_freq_in_Hz)) ## join the frequency data to the vocal activity data vocal_act &lt;- vocal_act %&gt;% left_join(median_pf, by = c(&#39;eBird_codes&#39;, &#39;time_of_day&#39;)) %&gt;% drop_na() # A total of 66 species were included and three species were excluded from final analysis. 9.9 Foraging guild We prepare foraging guild categories for the PGLS analysis vocal_act &lt;- vocal_act %&gt;% left_join(trait[,c(1,2,29)], by = c(&#39;scientific_name&#39;, &#39;common_name&#39;)) ## remove species that are poorly represented by a particular trophic niche ## we get rid of nectarivore species, aquatic predator and granivore vocal_act &lt;- vocal_act %&gt;% filter(trophic_niche != &quot;Aquatic predator&quot;) %&gt;% filter(trophic_niche != &quot;Granivore&quot;) %&gt;% filter(trophic_niche != &quot;Nectarivore&quot;) %&gt;% filter(trophic_niche != &quot;Vertivore&quot;) vocal_act &lt;- vocal_act %&gt;% mutate(trophic_niche = case_when (trophic_niche %in% &#39;Invertivore&#39; ~ &#39;1&#39;, trophic_niche %in% &#39;Frugivore&#39; ~ &#39;2&#39;, trophic_niche %in% &#39;Omnivore&#39; ~&#39;3&#39;)) ## Only 62 species remain at this stage. 9.10 Data cleaning We clean the objects prior to running PGLS regressions # converting the scientific names of vocal_act as per tip.labels of the tree vocal_act &lt;- vocal_act %&gt;% mutate(across(scientific_name, str_replace, &#39; &#39;, &#39;_&#39;)) # converting the scientific names of vocal_act as per the birdtree data so that both are matching vocal_act &lt;- vocal_act %&gt;% mutate(scientific_name = case_when (scientific_name == &#39;Dumetia_atriceps&#39; ~ &#39;Rhopocichla_atriceps&#39;, scientific_name == &#39;Chrysocolaptes_guttacristatus&#39; ~ &#39;Chrysocolaptes_lucidus&#39;, scientific_name == &#39;Turdus_simillimus&#39; ~ &#39;Turdus_merula&#39;, scientific_name == &#39;Larvivora_brunnea&#39; ~ &#39;Luscinia_brunnea&#39;, scientific_name == &#39;Machlolophus_aplonotus&#39; ~ &#39;Parus_xanthogenys&#39;, scientific_name == &#39;Psilopogon_malabaricus&#39; ~ &#39;Megalaima_rubricapillus&#39;, scientific_name == &#39;Tephrodornis_sylvicola&#39; ~ &#39;Tephrodornis_gularis&#39;, scientific_name == &#39;Geokichla_citrina&#39; ~ &#39;Zoothera_citrina&#39;, scientific_name == &#39;Cinnyris_asiaticus&#39; ~ &#39;Nectarinia_asiatica&#39;, scientific_name == &#39;Leptocoma_minima&#39; ~&#39;Nectarinia_minima&#39;, scientific_name == &#39;Spilopelia_chinensis&#39; ~&#39;Stigmatopelia_chinensis&#39;, scientific_name == &#39;Argya_subrufa&#39; ~ &#39;Turdoides_subrufa&#39;, scientific_name == &#39;Ficedula_nigrorufa&#39; ~ &#39;Muscicapa_ruficauda&#39;, scientific_name == &#39;Gracula_indica&#39; ~ &#39;Gracula_religiosa&#39;, scientific_name == &#39;Ketupa_nipalensis&#39; ~ &#39;Bubo_nipalensis&#39;, scientific_name == &#39;Hypsipetes_ganeesa&#39; ~ &#39;Hypsipetes_leucocephalus&#39;, scientific_name == &#39;Cyornis_pallidipes&#39; ~ &#39;Cyornis_pallipes&#39;, scientific_name == &#39;Psilopogon_viridis&#39; ~ &#39;Megalaima_viridis&#39;, .default = scientific_name)) #final dataframe with variables # check same species in vocal_act and phylogenetic data, and pruning species from the tree which are not present in the vocal_act data diff &lt;- setdiff(tree$tip.label, vocal_act$scientific_name) pruned.tree &lt;- drop.tip (tree, diff) #final phylogenetic dataframe setdiff(vocal_act$scientific_name,pruned.tree$tip.label) #checking if vocal_act and pruned.tree have the same species: result- &#39;character(0)&#39; 9.11 PGLS analysis Here we test if the higher rates of acoustic detections at dawn can be explained by environmental and/or social factors ## reference categories for categorical predictors/factors ## Territoriality: 1 = Non-territorial, 2 = Weakly territorial, 3 = Highly territorial ## Sociality: 0 = Non-communal signallers, 1 = Communal signallers ## Trophic niche: 1 = Invertivore, 2 = Frugivore, 3 = Omnivore ## Using normalized detections for dawn only # Univariate models: # percent_normalized_detections ~ median_startTime only model1 &lt;- vocal_act %&gt;% filter(time_of_day == &quot;dawn&quot;) %&gt;% gls (percent_normalized_detections ~ scale (median_startTime), data = ., correlation = corPagel(1, pruned.tree, form = ~scientific_name)) summary (model1) #AIC = 490.9885 # percent_normalized_detections ~ territoriality only model2 &lt;- vocal_act %&gt;% filter(time_of_day == &quot;dawn&quot;) %&gt;% gls(percent_normalized_detections ~ relevel(factor(territory), ref = 3), data = ., correlation = corPagel(1, pruned.tree, form = ~scientific_name)) summary(model2) #AIC = 490.3102 # percent_normalized_detections ~ sociality only model3 &lt;- vocal_act %&gt;% filter(time_of_day == &quot;dawn&quot;) %&gt;% gls(percent_normalized_detections ~ factor(sociality), data = ., correlation = corPagel(1, pruned.tree, form = ~scientific_name)) summary(model3) #490.9651 # percent_normalized_detections ~ median_peak_freq only model4 &lt;- vocal_act %&gt;% filter(time_of_day == &quot;dawn&quot;) %&gt;% gls(percent_normalized_detections ~ scale (median_peak_freq), data = ., correlation = corPagel(1, pruned.tree, form = ~scientific_name)) summary(model4) #AIC = 498.3634 # percent_normalized_detections ~ trophic_niche only model5 &lt;- vocal_act %&gt;% filter(time_of_day == &quot;dawn&quot;) %&gt;% gls(percent_normalized_detections ~ relevel(factor(trophic_niche), ref = 1), data = ., correlation = corPagel(1, pruned.tree, form = ~scientific_name)) summary(model5) #AIC = 488.6914 # Multi-variate model with all predictor variables: model &lt;- vocal_act %&gt;% filter(time_of_day == &quot;dawn&quot;) %&gt;% gls(percent_normalized_detections ~ scale(median_startTime) + relevel(factor(territory), ref = 3) + factor(sociality) + scale(median_peak_freq) + relevel(factor(trophic_niche), ref = 2), data = ., correlation = corPagel(1, pruned.tree, form = ~scientific_name)) summary(model) #AIC = 463.691 plot_model(model) ## Sociality (communal signallers) showed a weak, but significant positive association with percent_normalized_detections ## Here we will run a model using dusk data anyway model6 &lt;- vocal_act %&gt;% filter(time_of_day == &quot;dusk&quot;) %&gt;% gls(percent_normalized_detections ~ scale(median_startTime) + relevel(factor(territory), ref = 3) + factor(sociality) + scale(median_peak_freq) + relevel(factor(trophic_niche), ref = 1), data = ., correlation = corPagel(1, pruned.tree, form = ~scientific_name)) summary(model6) plot_model(model6) ## No significant association was detected between dusk data and any environmental/social factors (when controlled for phylogeny) "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]
